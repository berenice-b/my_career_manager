<!-- Begin page -->
<div class="wrapper">

  <!-- ============================================================== -->
  <!-- Start Page Content here -->
  <!-- ============================================================== -->

  <div class="content-page">



      <!-- Start Content-->
      <div class="container-fluid">


        <!-- start page title -->
        <div class="row">
          <div class="col-12">
            <div class="page-title-box">
              <h2 class="text-center display-5 index-title">MY APPLICATION BOARD</h2>
            </div>
          </div>
        </div>
        <!-- end page title -->

        <div class="row">
          <div class="col-12 text-center">
            <div>


            <!----- NEXT STEPS --->

              <!-----END NEXT STEPS --->


              <!-----NEXT STEPS --->
              <div class="tasks mr-4">
                <h5 class="mt-0 task-header text-uppercase text-center bg-transparentblack">
                    <span>MY NEXT STEPS</span>
                    </h5>
                <div id="task-list-one" class="task-list-items">

                  <%if @next_steps.count == 0%>
                    <a class = "text-white"> Nothing on your agenda!</a>
                  <%end%>

                <% @next_steps.each do |next_step| %> <!-- Starts Next Steps Cards Loop -->

                  <div class="card mb-0"> <!-- Start card -->
                    <div class="card-body p-3"> <!-- Start card body -->


                      <h5 class="mt-2 mb-2 next-step">
                        <%= link_to next_step.application.company_name, application_path(next_step.application), class: "text-body break-word", toggle: "modal" %>
                      </h5>

                      <span class="badge <%= 'badge-success' if next_step.category == 'interview' %>
                      <%= 'badge-warning' if next_step.category == 'phone interview' %><%= 'badge-info' if next_step.category == 'follow-up' %>">
                        <%= next_step.category %>
                      </span>
                      
                      <small class="float-right badge <%= 'badge-success-lighten' if next_step.category == 'interview' %><%= 'badge-warning-lighten' if next_step.category == 'phone interview' %><%= 'badge-info-lighten' if next_step.category == 'follow-up' %>">
                        <% unless next_step.date == nil %>
                        <%= next_step.date.strftime '%a %m/%d' %>
                        <% end %>
                      </small>     

                    </div> <!-- End card-body -->
            
                  </div> <!-- End card -->

                  <% end %> <!-- End Next Steps Cards Loop -->


                </div> <!-- end company-list-2-->
              </div>
              <!-----END NEXT STEPS --->




              <!-----IDENTIFIED --->
              <div class="tasks mr-1">
                <h5 class="mt-0 task-header text-uppercase">
                    <span>Identified (<%= @identified.length %>)</span>
                    <span><button type="button" class="btn btn-itmeo" data-toggle="modal" data-target="#new-modal-identified"><i class="fas fa-plus"></i></button></span>
                </h5>
                <div id="task-list-two" class="task-list-items">

                  <!-- Task Item -->
                  <% @applications.each do |application| %>
                  <% if application.status == "identified" %>
                  <div class="card mb-0">
                    <div class="card-body p-0">

                      <h5 class="mt-2 mb-2">
                        <%= link_to application.company_name, application_path(application), class: "text-body", toggle: "modal" %>
                      </h5>

                      <p class="mb-0">
                        <span class="pr-2 mb-2 d-inline-block">
                          <%= application.position %></span>
                      </p>
                    </div> <!-- end card-body -->
                  </div>
                  <% end %>
                  <% end %>
                  <!-- Task Item End -->


                </div> <!-- end company-list-2-->
              </div>
              <!-----END IDENTIFIED --->



              <div class="tasks mr-1">
                <h5 class="mt-0 task-header text-uppercase">
                  <span>Applied (<%= @applied.length %>)</span>
                  <span><button type="button" class="btn btn-itmeo button-header-3" data-toggle="modal" data-target="#new-modal-applied"><i class="fas fa-plus"></i></button></span>
                </h5>

                <div id="task-list-three" class="task-list-items">

                  <!-- Task Item -->
                  <% @applications.each do |application| %>
                  <% if application.status == "applied" %>
                  <div class="card mb-0">
                    <div class="card-body p-0">

                      <h5 class="mt-2 mb-2">
                        <%= link_to application.company_name, application_path(application), class: "text-body", toggle: "modal" %>
                      </h5>

                      <p class="mb-0">
                        <span class="pr-2 mb-2 d-inline-block">
                          <%= application.position %></span>
                      </p>

                    </div> <!-- end card-body -->
                  </div>
                  <% end %>
                  <% end %>
                  <!-- Task Item End -->

                </div> <!-- end company-list-3-->
              </div>

              <div class="tasks">
                <h5 class="mt-0 task-header text-uppercase">
                  <span>In Progress (<%= @in_progress.length %>)</span>
                  <span><button type="button" class="btn btn-itmeo button-header-4" data-toggle="modal" data-target="#new-modal-in_progress"><i class="fas fa-plus"></i></button></span>
                </h5>
                <div id="task-list-four" class="task-list-items">

                  <!-- Task Item -->
                  <% @applications.each do |application| %>
                  <% if application.status == "in_progress" %>
                  <div class="card mb-0">
                    <div class="card-body p-1">


                      <h5 class="mb-2">
                        <%= link_to application.company_name, application_path(application), class: "text-body", toggle: "modal" %>
                      </h5>

                      <p class="mb-0">
                        <span class="pr-2 d-inline-block">
                          <%= application.position %>
                        </span>
                      </p>


                      <% categories = [] %>
                      <% application.steps.each do |step| %>
                      <% categories << step.category %>
                      <% end %>

                      <span class="m-1 float-center badge <%= 'badge-success' if categories.last == 'interview' %><%= 'badge-warning' if categories.last == 'phone interview' %><%= 'badge-info' if categories.last == 'follow-up' %>">
                        <%= categories.last %>
                      </span>
                      <!--
                      <small class="float-right badge <%= 'badge-success-lighten' if categories.last == 'interview' %><%= 'badge-warning-lighten' if categories.last == 'phone interview' %><%= 'badge-info-lighten' if categories.last == 'follow-up' %>">
                        <% dates = [] %>
                        <% application.steps.each do |step| %>
                        <% dates << step.date %>
                        <% end %>
                        <% unless dates.last == nil %>
                        <%= dates.last.strftime '%a %m/%d' %>
                        <% end %>
                      </small>
                      -->

                    </div> <!-- end card-body -->
                  </div>
                  <% end %>
                  <% end %>
                  <!-- Task Item End -->

                </div> <!-- end company-list-4-->
              </div>

            </div> <!-- end .board-->
          </div> <!-- end col -->
        </div>
        <!-- end row-->

      </div> <!-- container -->

    </div> <!-- content -->


  <!-- ============================================================== -->
  <!-- End Page content -->
  <!-- ============================================================== -->


</div>



<!-- beginning modal -->
<div id="new-modal-identified" class="modal fade" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="card">
              <!-- Logo-->
              <div class="card-header pt-4 pb-4 text-center bg-primary">
                  <h4 style="color:white">New Application</h4>
              </div>

              <div class="card-body p-4">
                  
                  <%= form_tag url_for(action: 'create'), method: "post" do %>
                  <div class="form-group">
                      <%= label_tag 'Company *' %><br />
                      <%= text_field_tag :company_name, "", class: 'form-control', placeholder: 'Enter company name', required: true %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Job title *' %><br />
                      <%= text_field_tag :position, "", class: 'form-control', placeholder: 'Enter job title', required: true %>
                  </div>
                  <div class="form-group hidden-form">
                      <%= label_tag 'Status *' %><br />
                      <%= text_field_tag :status, "identified", class: 'form-control' %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Link to job offer' %><br />
                      <%= url_field_tag :joboffer_link, "", class: 'form-control', placeholder: 'Enter link' %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Job offer description' %><br />
                      <%= text_area_tag :joboffer_description, "", class: 'form-control', placeholder: 'Enter a description or copy-paste the job offer', size: "20x3"  %>
                  </div>
                  <div class="form-group">
                      <%= label_tag '' %><br />
                      <%= submit_tag "Add new application", class:"btn btn-primary" %>
                  </div>
                  <% end %>
              </div> <!-- end card-body -->
          </div>
          <!-- end card-body -->
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!--end modal -->
  <!-- beginning modal -->
<div id="new-modal-applied" class="modal fade" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="card">
              <!-- Logo-->
              <div class="card-header pt-4 pb-4 text-center bg-primary">
                  <h4 style="color:white">New Application</h4>
              </div>

              <div class="card-body p-4">

                  <%= form_tag url_for(action: 'create'), method: "post" do %>
                  <div class="form-group">
                      <%= label_tag 'Company *' %><br />
                      <%= text_field_tag :company_name, "", class: 'form-control', placeholder: 'Enter company name' %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Job title *' %><br />
                      <%= text_field_tag :position, "", class: 'form-control', placeholder: 'Enter job title' %>
                  </div>

                  <div class="form-group hidden-form">
                      <%= label_tag 'Status *' %><br />
                      <%= text_field_tag :status, "applied", class: 'form-control' %>
                  </div>

                  <div class="form-group">
                      <%= label_tag 'Link to job offer' %><br />
                      <%= url_field_tag :joboffer_link, "", class: 'form-control', placeholder: 'Enter link' %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Job offer description' %><br />
                      <%= text_area_tag :joboffer_description, "", class: 'form-control', placeholder: 'Enter a description or copy-paste the job offer', size: "20x3"  %>
                  </div>
                  <div class="form-group">
                      <%= label_tag '' %><br />
                      <%= submit_tag "Add new application", class:"btn btn-primary" %>
                  </div>
                  <% end %>
              </div> <!-- end card-body -->
          </div>
          <!-- end card-body -->
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!--end modal -->
  <!-- beginning modal -->
<div id="new-modal-in_progress" class="modal fade" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="card">
              <!-- Logo-->
              <div class="card-header pt-4 pb-4 text-center bg-primary">
                  <h4 style="color:white">New Application</h4>
              </div>

              <div class="card-body p-4">

                  <%= form_tag url_for(action: 'create'), method: "post" do %>
                  <div class="form-group">
                      <%= label_tag 'Company *' %><br />
                      <%= text_field_tag :company_name, "", class: 'form-control', placeholder: 'Enter company name' %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Job title *' %><br />
                      <%= text_field_tag :position, "", class: 'form-control', placeholder: 'Enter job title' %>
                  </div>

                  <div class="form-group hidden-form">
                      <%= label_tag 'Status *' %><br />
                      <%= text_field_tag :status, "in_progress", class: 'form-control' %>
                  </div>

                  <div class="form-group">
                      <%= label_tag 'Link to job offer' %><br />
                      <%= url_field_tag :joboffer_link, "", class: 'form-control', placeholder: 'Enter link' %>
                  </div>
                  <div class="form-group">
                      <%= label_tag 'Job offer description' %><br />
                      <%= text_area_tag :joboffer_description, "", class: 'form-control', placeholder: 'Enter a description or copy-paste the job offer', size: "20x3"  %>
                  </div>
                  <div class="form-group">
                      <%= label_tag '' %><br />
                      <%= submit_tag "Add new application", class:"btn btn-primary" %>
                  </div>
                  <% end %>
              </div> <!-- end card-body -->
          </div>
          <!-- end card-body -->
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!--end modal -->